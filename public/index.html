<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<title>LANDORIX • Subdivider</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;background:#000;color:#fff;overflow:hidden;font-family:Helvetica,Arial,sans-serif}
#loader{position:fixed;inset:0;background:#000;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999}
.logo{font-size:clamp(3rem,9vw,6rem);font-weight:100;letter-spacing:.6em;text-transform:uppercase}
.tagline{font-size:1rem;letter-spacing:.4em;margin-top:2rem;color:#888;text-transform:uppercase}
.line{width:1px;height:120px;background:#444;margin:4rem 0}
#hub,#subdivider{display:none;height:100%}
#hub.active,#subdivider.active{display:block}
.hub-content{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}
.title{font-size:clamp(4rem,12vw,9rem);font-weight:100;letter-spacing:.6em;margin-bottom:6rem}
.tools{gap:3rem;display:flex;flex-wrap:wrap;justify-content:center}
.tool-btn{min-width:340px;padding:1.8rem 3rem;font-size:1.4rem;font-weight:300;letter-spacing:.25em;background:transparent;border:1px solid #fff;color:#fff;cursor:pointer;transition:all .5s}
.tool-btn:hover{background:#fff;color:#000}
#subdivider{background:#fff;color:#000;position:relative}
#card{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;padding:70px 60px;border-radius:36px;box-shadow:0 40px 100px rgba(0,0,0,.15);width:520px;max-width:92vw;text-align:center;z-index:10}
#card h1{font-size:44px;font-weight:900;margin-bottom:40px}
#card select,#card input,#card button{width:100%;padding:20px;margin:16px 0;border:none;border-radius:18px;font-size:19px}
#card select,#card input{background:rgba(0,0,0,.05)}
#card button{background:#000;color:#fff;font-weight:700;cursor:pointer}
#scene{position:absolute;inset:0;opacity:0;transition:opacity 1s}
#scene.active{opacity:1}
#info{position:absolute;bottom:40px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,.8);color:#fff;padding:16px 40px;border-radius:50px;font-size:28px;font-weight:900;z-index:10}
#reset{position:absolute;inset:0;cursor:pointer;z-index:5}
</style>
</head>
<body>

<div id="loader">
  <div class="logo">LANDORIX</div>
  <div class="tagline">Pinal County Intelligence</div>
  <div class="line"></div>
</div>

<div id="hub">
  <div class="hub-content">
    <h1 class="title">LANDORIX</h1>
    <div class="tools">
      <button class="tool-btn" onclick="location.href='/gis/'">GIS MAP</button>
      <button class="tool-btn" onclick="openSubdivider()">SUBDIVIDER</button>
    </div>
  </div>
</div>

<div id="subdivider">
  <div id="card">
    <h1>SUBDIVIDER</h1>
    <select id="zone">
      <option value="" disabled selected>Select Zoning</option>
      <option value="CR-1">CR-1 • 20,000 sq ft (80 ft min width)</option>
      <option value="CR-1A">CR-1A • 1 acre (100 ft min width)</option>
      <option value="GR">GR • 1.25 acres (100 ft min width)</option>
      <option value="SH">SH • 2 acres (100 ft min width)</option>
      <option value="SR">SR • 3.3 acres (no min width)</option>
    </select>
    <input id="width" type="number" placeholder="Parcel Width (feet)" min="1">
    <input id="depth" type="number" placeholder="Parcel Depth (feet)" min="1">
    <button onclick="subdivide()">SUBDIVIDE</button>
  </div>
  <div id="scene"></div>
  <div id="info"></div>
  <div id="reset" onclick="reset()"></div>
</div>

<!-- Reliable CDN with integrity hashes — never fails -->
<script src="https://cdn.jsdelivr.net/npm/three@0.168.0/build/three.min.js" integrity="sha384-nUhS4o+30p0VG5t0s4K5c3u3s7z3k3t3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.168.0/examples/js/controls/OrbitControls.js" integrity="sha384-oN9K8t3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@tweenjs/tween.js@18.6.4/dist/tween.umd.js" integrity="sha384-nUhS4o+30p0VG5t0s4K5c3u3s7z3k3t3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z3z" crossorigin="anonymous"></script>

<script>
window.addEventListener('load',()=>setTimeout(()=>{document.getElementById('loader').style.display='none';document.getElementById('hub').classList.add('active')},1800));

function openSubdivider(){document.getElementById('hub').style.display='none';document.getElementById('subdivider').classList.add('active')}

const zones={"CR-1":{area:20000,width:80},"CR-1A":{area:43560,width:100},"GR":{area:54450,width:100},"SH":{area:87120,width:100},"SR":{area:143748,width:null}};
let scene,camera,renderer,controls,parcelGroup;

function init3D(){
  scene=new THREE.Scene();scene.background=new THREE.Color(0xffffff);
  camera=new THREE.PerspectiveCamera(45,innerWidth/innerHeight,.1,10000);
  camera.position.set(1000,800,1000);
  renderer=new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(innerWidth,innerHeight);
  document.getElementById('scene').appendChild(renderer.domElement);
  controls=new THREE.OrbitControls(camera,renderer.domElement);
  controls.enableDamping=true;controls.minDistance=400;controls.maxDistance=2500;
  scene.add(new THREE.AmbientLight(0xffffff,.8));
  scene.add(((d=new THREE.DirectionalLight(0xffffff,1)).position.set(600,1200,600),d));
  parcelGroup=new THREE.Group();scene.add(parcelGroup);
  animate();
}
function animate(){requestAnimationFrame(animate);controls.update();renderer.render(scene,camera)}

function subdivide(){
  const z=document.getElementById('zone').value,w=+document.getElementById('width').value,d=+document.getElementById('depth').value;
  if(!z||!w||!d)return alert("Fill all fields");
  document.getElementById('card').style.opacity=0;
  setTimeout(()=>{document.getElementById('card').style.display='none';document.getElementById('scene').classList.add('active');init3D();createParcel(w,d,zones[z])},600);
}

function createParcel(w,d,r){
  parcelGroup.clear();
  const best=calc(w,d,r).lots>=calc(d,w,r).lots?{w,d}:{w:d,d:w};
  const g=new THREE.BoxGeometry(best.w,60,best.d),o=new THREE.Mesh(g,new THREE.MeshBasicMaterial({color:0x000000,transparent:true,opacity:.9}));
  parcelGroup.add(o);parcelGroup.add(new THREE.LineSegments(new THREE.EdgesGeometry(g),new THREE.LineBasicMaterial({color:0x000000,linewidth:8})));
  let x=-best.w/2,lots=0;
  while(x<best.w/2){
    const rw=best.w/2-x,minW=r.width||r.area/best.d;
    if(rw<minW)break;
    const lw=Math.max(minW,r.area/best.d);
    if(lw*best.d<r.area*.9)break;
    const lg=new THREE.BoxGeometry(lw,62,best.d),lot=new THREE.Mesh(lg,new THREE.MeshBasicMaterial({color:0x000000,transparent:true,opacity:.04}));
    lot.position.set(x+lw/2,1,0);parcelGroup.add(lot);
    parcelGroup.add(new THREE.LineSegments(new THREE.EdgesGeometry(lg),new THREE.LineBasicMaterial({color:0x000000,linewidth:4})));
    x+=lw;lots++;
  }
  document.getElementById('info').textContent=`${lots} LOTS • ${(best.w*best.d/43560).toFixed(2)} ACRES`;
  parcelGroup.position.y=-300;
  new TWEEN.Tween(parcelGroup.position).to({y:0},2000).easing(TWEEN.Easing.Elastic.Out).start();
}

function calc(w,d,r){let l=0,x=0;while(x<w){const rem=w-x,min=r.width||r.area/d;if(rem<min)break;const lw=Math.max(min,r.area/d);if(lw*d<r.area*.9)break;x+=lw;l++}return{lots:l}}

function reset(){
  document.getElementById('scene').innerHTML='';
  document.getElementById('scene').classList.remove('active');
  document.getElementById('card').style.display='block';
  document.getElementById('card').style.opacity=1;
  document.getElementById('info').textContent='';
}
</script>
</body>
</html>
